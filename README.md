# Печать этикеток ячеек ПВЗ

Утилита для автоматической печати номеров ячеек на термопринтер при работе с системами:
- Турбо-ПВЗ (Ozon)
- ВВПВЗ (Wildberries)

## Возможности

- Автоматическое обнаружение номеров ячеек на страницах приемки
- Печать на термопринтер с поддержкой ESC/POS
- Поддержка различных типов принтеров (Serial, USB, Network)
- Печать QR-кода с номером ячейки
- Браузерное расширение для Chrome, Яндекс.Браузера и Edge
- Гибкие настройки печати

## Поддерживаемые платформы

- Windows
- macOS
- Linux

## Требования

**ВНИМАНИЕ: Для работы программы требуется Python 3.7 или выше.**

Если Python не установлен:

**Windows:**
1. Скачайте Python с [python.org](https://www.python.org/downloads/)
2. При установке **обязательно отметьте** "Add Python to PATH"
3. Перезагрузите компьютер после установки

**macOS:**
```bash
brew install python3
```

**Linux (Ubuntu/Debian):**
```bash
sudo apt-get install python3 python3-pip
```

## Установка

### Windows

1. **Убедитесь, что Python установлен** (запустите `python --version` в командной строке)
2. Запустите `УСТАНОВКА.bat` (двойной клик)
3. Запустите `ЗАПУСТИТЬ_ПРОСТО.bat` для запуска сервера

### macOS / Linux

1. **Убедитесь, что Python3 установлен** (запустите `python3 --version` в терминале)
2. Запустите установку:
   ```bash
   chmod +x УСТАНОВКА.sh
   ./УСТАНОВКА.sh
   ```

3. Запустите сервер:
   ```bash
   ./ЗАПУСТИТЬ.sh
   ```

### Установка зависимостей вручную

```bash
pip install -r requirements.txt
```

Для macOS может потребоваться:
```bash
brew install libusb
```

Для Linux может потребоваться:
```bash
sudo apt-get install libusb-1.0-0-dev
```

## Настройка принтера

Откройте файл `config.json` и настройте параметры вашего принтера:

### Для Serial принтера (через COM-порт):

**Windows:**
```json
{
  "type": "serial",
  "serial_port": "COM3",
  "serial_baudrate": 9600
}
```

**macOS:**
```json
{
  "type": "serial",
  "serial_port": "/dev/tty.usbserial-*",
  "serial_baudrate": 9600
}
```

**Linux:**
```json
{
  "type": "serial",
  "serial_port": "/dev/ttyUSB0",
  "serial_baudrate": 9600
}
```

### Для USB принтера:
```json
{
  "type": "usb",
  "vendor_id": 1200,
  "product_id": 8258
}
```

### Для сетевого принтера:
```json
{
  "type": "network",
  "network_host": "192.168.1.100",
  "network_port": 9100
}
```

## Запуск сервера

Сервер запустится на `http://localhost:5001`

### Windows:
Двойной клик на `ЗАПУСТИТЬ_ПРОСТО.bat`

### macOS / Linux:
```bash
./ЗАПУСТИТЬ.sh
```

Или напрямую:
```bash
python3 server.py
```

## Установка браузерного расширения

### Chrome
1. Откройте `chrome://extensions/`
2. Включите "Режим разработчика"
3. Нажмите "Загрузить распакованное расширение"
4. Выберите папку `extension` (где находится `manifest.json`)

### Яндекс.Браузер
1. Откройте `browser://extensions/` или меню → Дополнения → Управление дополнениями
2. Включите "Режим разработчика"
3. Нажмите "Загрузить распакованное расширение"
4. Выберите папку `extension` (где находится `manifest.json`)

### Edge
1. Откройте `edge://extensions/`
2. Включите "Режим разработчика"
3. Нажмите "Загрузить распакованное расширение"
4. Выберите папку `extension` (где находится `manifest.json`)

Подробная инструкция: `extension/README_РАСШИРЕНИЕ.txt`

## Использование

### Автоматическая печать

1. Убедитесь, что сервер печати запущен
2. Откройте страницу приемки в Турбо-ПВЗ или ВВПВЗ
3. Когда системе присвоит ячейку заказу, она автоматически будет отправлена на печать
4. Принтер напечатает этикетку с номером ячейки и QR-кодом

### Тестовая печать

1. Кликните на иконку расширения в браузере
2. Введите номер ячейки в поле "Тестовая ячейка"
3. Нажмите "Печать тестовой ячейки"

### Настройки расширения

В popup расширения можно:
- Включить/выключить автопечать
- Изменить URL сервера печати (если сервер на другом компьютере)

## Технические детали

- Протокол печати: ESC/POS
- Формат этикетки: 58мм ширина (стандартная), настраивается
- Поддерживаемые принтеры: любые термопринтеры с поддержкой ESC/POS
  - Epson TM-T20, TM-T82, TM-T88
  - Star Micronics TSP100, TSP650
  - Zebra GC420d, ZD220
  - И другие

## Структура проекта

```
.
├── manifest.json          # Манифест расширения
├── content.js            # Скрипт для перехвата ячеек
├── popup.html/js         # Интерфейс настроек
├── background.js         # Фоновая служба расширения
├── server.py             # Сервер для печати
├── config.json           # Конфигурация принтера
├── requirements.txt      # Python зависимости
└── README.md            # Документация
```

## Альтернатива: Создание EXE-файла (не требует Python у пользователя)

Если вы хотите создать исполняемый файл, который не требует установки Python на компьютере пользователя:

1. У вас должен быть установлен Python
2. Запустите `СОЗДАТЬ_EXE.bat`
3. Файл `Печать_Ячеек_ПВЗ.exe` будет создан в папке `dist`
4. Скопируйте всю папку `dist` пользователю

**ВАЖНО:** 
- EXE-файл работает только на Windows
- Пользователю все равно нужно установить расширение браузера отдельно
- Подробная инструкция: `ИНСТРУКЦИЯ_EXE.md`

## Поддержка

Подробная инструкция по установке: `INSTALL_RU.md`
